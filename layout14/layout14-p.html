<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hibo â€” Dynamic Storyboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&display=swap" rel="stylesheet" />
  <style>
    body { font-family: 'Poppins', sans-serif; }
    .char { display: inline-block; aria-hidden: true; }
    .fade-overlay {
      position: fixed;
      inset: 0;
      background: #000;
      opacity: 0;
      z-index: 50;
      pointer-events: none; /* Will toggle dynamically */
      transition: opacity 0.6s ease;
    }
    .layer {
      position: absolute;
      inset: 0;
      background-size: cover;
      background-position: center;
      opacity: 0;
      transform-origin: center;
      filter: brightness(0.82);
      will-change: transform opacity background-position;
    }
    #confetti-container > div {
      will-change: transform, opacity;
    }
  </style>
</head>
<body class="bg-black text-white overflow-x-hidden">

  <!-- Story container -->
  <div id="pin-container" class="relative w-full h-screen overflow-hidden"></div>
  <div id="fade-overlay" class="fade-overlay"></div>

  <!-- CTA -->
  <section id="cta-section" class="relative w-full h-screen flex flex-col items-center justify-center bg-gradient-to-br from-[#0F0F23] via-[#1A1A2E] to-[#16213E] p-6 text-center">
    <h2 class="text-4xl md:text-6xl font-bold mb-4">Start Your Journey</h2>
    <p class="max-w-xl mb-6">Transform your life through the power of small, consistent habits. Every expert was once a beginner.</p>
    <a id="cta-button" class="px-6 py-3 rounded-full bg-yellow-400 text-black font-bold hover:scale-105 transition">Begin Your Transformation ðŸš€</a>
    <div id="confetti-container" class="absolute inset-0 pointer-events-none"></div>
  </section>

  <!-- GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
  <script>
    gsap.registerPlugin(ScrollTrigger);

    // -------------------------
    // Animation presets (text)
    // -------------------------
    const textEffects = {
      fadeUp: { y: 60, opacity: 0, stagger: 0.03, ease: "power2.out" },
      scaleIn: { scale: 0.5, opacity: 0, stagger: 0.04, ease: "back.out(1.7)" },
      fadeIn: { opacity: 0, stagger: 0.05, ease: "power1.inOut" },

      intenseText: (chars, tl, layer) => {
        tl.from(chars, { scale: 1.8, opacity: 0, stagger: 0.02, ease: "power4.out" }, "<");
        tl.to(chars, { scale: 1.05, repeat: 2, yoyo: true, duration: 0.25, ease: "sine.inOut" }, ">0.1");
      }
    };

    // -------------------------
    // Image/Layer presets (image)
    // -------------------------
    const imageEffects = {
      none: (layer, tl) => {},

      zoomIn: (layer, tl) => {
        tl.to(layer, { scale: 1.18, duration: 2, ease: "power1.inOut" }, "<");
      },

      panRight: (layer, tl) => {
        tl.fromTo(layer, { backgroundPositionX: "40%" }, { backgroundPositionX: "60%", duration: 2, ease: "none" }, "<");
      },

      zoomAndPan: (layer, tl) => {
        tl.to(layer, { scale: 1.25, backgroundPositionY: "60%", duration: 2, ease: "power1.inOut" }, "<");
      },

      intenseZoomShake: (layer, tl) => {
        tl.to(layer, { scale: 1.6, duration: 1.2, ease: "power2.inOut" }, "<");
        tl.to(layer, { x: "+=12", y: "+=8", repeat: 6, yoyo: true, duration: 0.04, ease: "none" }, ">=0.1");
      }
    };

    // -------------------------
    // Story config: each scene picks its textEffect and imageEffect
    // -------------------------
    const storyConfig = {
      scenes: [
        {
          text: "This is Hibo.",
          image: "https://images.unsplash.com/photo-1540553016722-983e48a2cd10?w=1920&h=1080&fit=crop",
          textEffect: "fadeUp",
          imageEffect: "zoomIn",
          textStyle: { size: "text-5xl md:text-7xl", color: "text-white", position: "items-center", width: "max-w-3xl" }
        },
        {
          text: "A burst of motivation.",
          image: "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=1920&h=1080&fit=crop",
          textEffect: "scaleIn",
          imageEffect: "zoomAndPan",
          textStyle: { size: "text-4xl md:text-6xl", color: "text-yellow-300", position: "items-start", width: "max-w-2xl" }
        },
        {
          text: "Until he couldn't anymore.",
          image: "https://images.unsplash.com/photo-1568602471122-7832951cc4c5?w=1920&h=1080&fit=crop",
          textEffect: "intenseText",
          imageEffect: "intenseZoomShake",
          textStyle: { size: "text-5xl md:text-7xl", color: "text-red-500", position: "items-center", width: "max-w-2xl" }
        }
      ]
    };

    // -------------------------
    // Build DOM (layers + text containers)
    // -------------------------
    const pinContainer = document.getElementById("pin-container");
    const fadeOverlay = document.getElementById("fade-overlay");
    const layers = [];
    const textNodes = [];

    storyConfig.scenes.forEach(scene => {
      const layer = document.createElement("div");
      layer.className = "layer";
      layer.style.backgroundImage = `url('${scene.image}')`;
      pinContainer.appendChild(layer);
      layers.push(layer);

      const textWrap = document.createElement("div");
      textWrap.className = `absolute inset-0 flex justify-center ${scene.textStyle.position} text-center font-extrabold ${scene.textStyle.size} ${scene.textStyle.color} px-6 ${scene.textStyle.width} opacity-0`;
      // Add aria-hidden for chars for accessibility; provide full text in offscreen span
      textWrap.setAttribute("aria-label", scene.text);
      textWrap.setAttribute("role", "heading");
      textWrap.setAttribute("aria-level", "1");
      textWrap.innerHTML = scene.text.split("").map(c => `<span class="char" aria-hidden="true">${c === " " ? "&nbsp;" : c}</span>`).join("");
      pinContainer.appendChild(textWrap);
      textNodes.push({ el: textWrap, textEffect: scene.textEffect, imageEffect: scene.imageEffect });
    });

    // -------------------------
    // Calculate total scroll length dynamically (per scene: 2500 px scroll)
    // -------------------------
    const scrollLengthPerScene = 2500;
    const totalScrollLength = scrollLengthPerScene * storyConfig.scenes.length;

    // -------------------------
    // Master timeline with fade-to-black transitions between scenes
    // -------------------------
    const masterTl = gsap.timeline({
      scrollTrigger: {
        trigger: pinContainer,
        pin: true,
        scrub: 1,
        end: `+=${totalScrollLength}`,
        invalidateOnRefresh: true
      }
    });

    textNodes.forEach((node, i) => {
      const layer = layers[i];
      const textEl = node.el;
      const chars = textEl.querySelectorAll(".char");

      // Enable pointer events on fade overlay only during transition (fade in)
      function toggleFadeOverlayPointerEvents(enable) {
        fadeOverlay.style.pointerEvents = enable ? "auto" : "none";
      }

      // fade overlay -> reveal scene
      masterTl.to(fadeOverlay, { opacity: 0, duration: 0.5, onStart: () => toggleFadeOverlayPointerEvents(false) });

      // show layer & text
      masterTl.to(layer, { opacity: 1, duration: 0.8 }, "<");
      masterTl.to(textEl, { opacity: 1, duration: 0.1 }, "<");

      // image effect (if any)
      const imgEffectFn = imageEffects[node.imageEffect] || imageEffects.none;
      imgEffectFn(layer, masterTl);

      // text effect (preset or function)
      const txtPreset = textEffects[node.textEffect] || textEffects.fadeUp;
      if (typeof txtPreset === "function") {
        txtPreset(chars, masterTl, layer);
      } else {
        masterTl.from(chars, txtPreset, "<");
      }

      // small hold of scene
      masterTl.to({}, { duration: 0.6 });

      // fade to black BEFORE next scene
      masterTl.to(fadeOverlay, { opacity: 1, duration: 0.6, onStart: () => toggleFadeOverlayPointerEvents(true) });

      // hide current layer/text and reset transforms for next scene
      masterTl.set(layer, { opacity: 0, scale: 1, x: 0, y: 0, backgroundPositionX: "50%", backgroundPositionY: "50%" });
      masterTl.set(textEl, { opacity: 0, clearProps: "transform" });
    });

    // Ensure overlay clears at the end so CTA is visible
    masterTl.to(fadeOverlay, { opacity: 0, duration: 0.6, onStart: () => fadeOverlay.style.pointerEvents = "none" });

    // -------------------------
    // CTA timeline + confetti
    // -------------------------
    const cta = document.getElementById("cta-section");
    const ctaTl = gsap.timeline({
      scrollTrigger: { trigger: cta, start: "top 80%", toggleActions: "play none none none" }
    });

    ctaTl.from(cta, { opacity: 0, scale: 0.95, duration: 0.9 });
    ctaTl.call(() => {
      if (!cta.dataset.confettiLaunched) {
        launchConfetti();
        cta.dataset.confettiLaunched = "true";
      }
    }, null, ">-0.3");

    function launchConfetti() {
      const container = document.getElementById("confetti-container");
      const colors = ['#FFD700', '#FF6347', '#00BFFF', '#32CD32', '#FF69B4', '#FFFFFF'];
      for (let i = 0; i < 120; i++) {
        const el = document.createElement("div");
        el.className = "absolute";
        el.style.width = "10px";
        el.style.height = "14px";
        el.style.left = `${Math.random() * 100}%`;
        el.style.top = `-10%`;
        el.style.background = colors[Math.floor(Math.random() * colors.length)];
        el.style.opacity = "0";
        el.style.borderRadius = "3px";
        el.style.transform = `rotate(${Math.random() * 360}deg)`;
        container.appendChild(el);
        gsap.to(el, {
          y: "110vh",
          x: gsap.utils.random(-200, 200),
          rotation: gsap.utils.random(360, 720),
          scale: gsap.utils.random(0.6, 1.4),
          opacity: 1,
          duration: gsap.utils.random(3, 6),
          delay: Math.random() * 1.8,
          ease: "power1.out",
          onComplete: () => el.remove()
        });
      }
    }

    // -------------------------
    // Expose presets for debugging or quick edits in console
    // -------------------------
    window.__HIBO = { textEffects, imageEffects, storyConfig };
  </script>
</body>
</html>
